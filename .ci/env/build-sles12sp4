zypper in cmake
zypper in gcc5 gcc5-c++
zypper in boost_1_61-devel
zypper in hwloc hwloc-devel
zypper in libnuma-devel
zypper in libQt5Core-devel libQt5Gui-devel libQt5Xml-devel libQt5Network-devel libQt5Widgets-devel
zypper in asciidoc
zypper in chrpath
zypper in source-highlight
zypper in glibc-devel-static
zypper in libssh2-devel

git clone https://github.com/cc-hpc-itwm/GPI-2.git
cd GPI-2
git checkout tags/v1.3.1
git submodule update --init --recursive
grep "^CC\s*=\s*gcc$" . -lR | xargs sed -i'' -e "s/^CC\s*=\s*gcc$/# DISABLED BY WORKBENCH: \\0/"
./install.sh -p "/home/projects/sdpa/external_software/gaspi/1.3.1+eth" --with-fortran=false --with-ethernet
cd ..
rm -rf GPI-2

_scriptdir=$(readlink -f ${BASH_SOURCE}); source "${_scriptdir%/*}"/common

external=/home/projects/sdpa/external_software

export BOOST_ROOT=${external}/boost/1.61
path chrpath/0.16/bin
path cmake/3.13.5/bin
path gcc/4.9.4/bin
path qt/5.9.1/bin
path asciidoc/8.6.9/bin
path source-highlight/3.1.7/bin
ld_library_path source-highlight/3.1.7/lib
pkg_config_path gaspi/1.3.1+eth/lib64/pkgconfig
pkg_config_path hwloc/1.10.1/lib/pkgconfig
pkg_config_path libssh2/1.7.0+fpic/lib/pkgconfig
pkg_config_path openssl/1.0.2g+fpic/lib/pkgconfig

export CC="${external}/ccache/3.2.4/lib/gcc"
export CXX="${external}/ccache/3.2.4/lib/g++"
export CCACHE_DIR="/tmp/gitlab-ci/.ccache"
export CCACHE_PATH=${external}/gcc/4.9.4/bin
ld_library_path gcc/4.9.4/lib64

gspc_testing_rif_strategy=ssh
gspc_parallel_test_and_build_jobs=$(nproc)
