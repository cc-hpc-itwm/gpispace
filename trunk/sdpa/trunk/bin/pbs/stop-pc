#!/bin/sh

test -r "$HOME/.sdpa/state/sdpa.env" && source "$HOME/.sdpa/state/sdpa.env"

user=$( id -un )

for p in nre-pcd ; do
    alive=true
    echo -n "Terminating $p..."
    for (( i=0; i < 3; ++i )); do
	echo -n "."
        killall -u "$user" -e -TERM "$p" >/dev/null 2>&1
	if [ $? -ne 0 ] ; then
	    alive=false
	fi
	if [ "$alive" == "false" ] ; then
	    echo "ok."
	    break
	fi
	sleep 0.5
    done
    if [ "$alive" == "true" ] ; then
        killall -u "$user" -ew -KILL "$p" >/dev/null 2>&1
	echo "killed."
    fi
done
