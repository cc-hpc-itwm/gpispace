#!/bin/bash

GSPC_DOC_SHORT_DESCRIPTION="execute commands remotely"

function usage ()
{
    cat >&2 <<EOF
usage: $(basename "$0") host command [args...]
EOF
}

ssh_opts="-q -x -T -n -C -4 -c arcfour,blowfish-cbc -o CheckHostIP=no -o StrictHostKeyChecking=no"

node="${1}"; shift

if [ -z "$node" ] ; then
    usage
    exit 1
fi

if [ $# -eq 0 ] ; then
    usage
    exit 1
fi

. $(gspc --exec-path)/gspc-sh-setup

gspc_log_trace rexec "$node $@"

if [ $(hostname -s) = "$node" ]
then
    "$@"
else
    ssh $ssh_opts $node "$@"
fi
