#!/bin/bash

GSPC_API_COMMAND_SHORT_DESCRIPTION="print the GPI-Space version"
GSPC_API_COMMAND_LEVEL=1

# levels: -1 - do not show in help output
#         >0 - show in help output of level L

. $(gspc --exec-path)/gspc-sh-setup

function usage()
{
    cat <<EOF
usage: version [-h|--help] [options]

   -r : print the exact revision instead of the version
EOF
}

TEMP=`getopt -o :hr --long help -n 'version' -- "$@"`

eval set -- "$TEMP"

mode="version"

while true ; do
    case "$1" in
        -h|--help) usage; exit ${GSPC_EX_OK} ;;
        -r) mode="revision" ; shift ;;
        --) shift; break ;;
    esac
done

case "${mode}" in
    version) gspc --version ; exit ${GSPC_EX_OK} ;;
    revision) gspc --revision ; exit ${GSPC_EX_OK} ;;
    *) gspc_log_error version "Invalid mode: '${mode}'" ; exit ${GSPC_EX_USAGE} ;;
esac
