#!/bin/bash

GSPC_API_COMMAND_SHORT_DESCRIPTION="print the GPI-Space version"
GSPC_API_COMMAND_LEVEL=1

# levels: -1 - do not show in help output
#         >0 - show in help output of level L

. $(gspc --exec-path)/gspc-sh-setup

function usage()
{
    cat <<EOF
usage: version [-h|--help] [options]
EOF
}

TEMP=`getopt -o hr --long help -n 'version' -- "$@"`

if [ $? != 0 ] ; then echo >&2 "try '-h' or '--help'. Terminating..." ; exit 1 ; fi

eval set -- "$TEMP"

mode="version"

while true ; do
    case "$1" in
        -h|--help) usage; exit 0 ;;
        -r) mode="revision" ; ;;
        --) shift; break ;;
        *) gspc_log_error version "Internal error on argument: '$1'"; exit 1 ;;
    esac
done

case "${mode}" in
    version) gspc --version ; exit 0 ;;
    revision) gspc --revision ; exit 0 ;;
    *) gspc_log_error version "Invalid mode: '${mode}'" ; exit 1 ;;
esac
